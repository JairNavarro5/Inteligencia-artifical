import pandas as pd
import numpy as np
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier
from sklearn.preprocessing import MinMaxScaler, StandardScaler
from sklearn.metrics import accuracy_score
from scipy.spatial.distance import euclidean

df = pd.read_csv(r"C:\Users\Jair Navarro\OneDrive\Escritorio\IA\cleaned_dataset.csv")
print(df.head())

X = df.iloc[:, :-1].values
y = df.iloc[:, -1].values

dist = euclidean(X[0], X[1])
print("Distancia Euclidiana:", dist)

X_train, X_test, y_train, y_test = train_test_split(X, y, test_size=0.2, random_state=42)

knn = KNeighborsClassifier(n_neighbors=5)
knn.fit(X_train, y_train)
y_pred = knn.predict(X_test)

print(pd.DataFrame({"Real": y_test, "Predicho": y_pred}).head(20))

accuracy_manual = sum(y_test == y_pred) / len(y_test)
print("Accuracy datos crudos:", accuracy_manual)

scaler_norm = MinMaxScaler()
X_norm = scaler_norm.fit_transform(X)

X_train_n, X_test_n, y_train_n, y_test_n = train_test_split(X_norm, y, test_size=0.2, random_state=42)

knn_n = KNeighborsClassifier(n_neighbors=5)
knn_n.fit(X_train_n, y_train_n)
acc_norm = accuracy_score(y_test_n, knn_n.predict(X_test_n))
print("Accuracy datos normalizados:", acc_norm)

scaler_std = StandardScaler()
X_std = scaler_std.fit_transform(X)

X_train_s, X_test_s, y_train_s, y_test_s = train_test_split(X_std, y, test_size=0.2, random_state=42)

knn_s = KNeighborsClassifier(n_neighbors=5)
knn_s.fit(X_train_s, y_train_s)
acc_std = accuracy_score(y_test_s, knn_s.predict(X_test_s))
print("Accuracy datos estandarizados:", acc_std)

tabla = pd.DataFrame({
    "MÃ©todo": ["KNN Crudo", "KNN Normalizado", "KNN Estandarizado"],
    "Accuracy": [accuracy_manual, acc_norm, acc_std]
})

print(tabla)
